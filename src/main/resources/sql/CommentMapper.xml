<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="CommentMapper">
    <resultMap id="commentSelectMap" type="comment">
        <result property="commentNo"            column="COMMENT_NO"             jdbcType="NUMERIC"/>
        <result property="commentPostNo"        column="COMMENT_POST_NO"        jdbcType="NUMERIC"/>
        <result property="commentUserId"        column="COMMENT_USER_ID"        jdbcType="VARCHAR"/>
        <result property="commentTruckId"       column="COMMENT_TRUCK_ID"       jdbcType="VARCHAR"/>
        <result property="commentContent"       column="COMMENT_CONTENT"        jdbcType="VARCHAR"/>
        <result property="commentDate"          column="COMMENT_DATE"           jdbcType="DATE"/>
        <result property="secretKey"            column="SECRET_KEY"             jdbcType="CHAR"/>
    </resultMap>

    <!-- SQL : INSERT -->
    <insert id="addComment"     parameterType="comment">
        INSERT INTO COMMENT (COMMENT_POST_NO, COMMENT_USER_ID, COMMENT_TRUCK_ID, COMMENT_CONTENT, COMMENT_DATE, SECRET_KEY)
        VALUES (#{commentPostNo}, #{commentUserId}, #{commentTruckId}, #{commentContent}, SYSDATE(), DEFAULT);
    </insert>

    <!-- SQL :SELECT ONE-->
    <select id="getComment"     parameterType="int"         resultMap="commentSelectMap">
        SELECT
            COMMENT_POST_NO, COMMENT_USER_ID, COMMENT_TRUCK_ID, COMMENT_CONTENT, COMMENT_DATE, SECRET_KEY
        FROM comment
        WHERE comment_no = #{commentNo}
    </select>

    <select id="getComment2"     parameterType="String"         resultMap="commentSelectMap">
        SELECT
            COMMENT_POST_NO, COMMENT_USER_ID, COMMENT_CONTENT, COMMENT_DATE, SECRET_KEY
        FROM comment
        WHERE comment_user_id = #{value}
    </select>

    <select id="getComment3"     parameterType="String"         resultMap="commentSelectMap">
        SELECT
            COMMENT_POST_NO, COMMENT_TRUCK_ID, COMMENT_CONTENT, COMMENT_DATE, SECRET_KEY
        FROM comment
        WHERE comment_truck_id = #{value}
    </select>


    <!-- SQL : SELECT LIST -->
    <select id="getCommentList"   parameterType="int"   resultMap="commentSelectMap">
        SELECT COMMENT_NO ,COMMENT_USER_ID, COMMENT_TRUCK_ID, COMMENT_CONTENT, COMMENT_DATE, SECRET_KEY
        FROM comment
        WHERE comment_post_no = ${value}
        order by COMMENT_NO DESC
--         limit 0,8;
    </select>

    <!-- SQL : UPDATE -->
    <update id="updateComment"  parameterType="comment">
        UPDATE comment
        <set>
            COMMENT_CONTENT = #{commentContent},
            COMMENT_DATE = SYSDATE()
        </set>
        WHERE comment_no = #{commentNo}
    </update>

    <!-- SQL : DELETE -->
    <delete id="deleteComment"  parameterType="comment">
        DELETE
        FROM comment
        where comment_no = {value }
    </delete>
</mapper>